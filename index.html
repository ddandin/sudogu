<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <!-- WEBVIEW FIX: Enhanced viewport meta for better mobile/WebView support -->
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no, viewport-fit=cover">
    <!-- iOS Web App meta tags for better WebView handling -->
    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-status-bar-style" content="black-translucent">
    <title>Sudogu - Dog Sudoku Game</title>
    <link rel="stylesheet" href="styles.css">
    <!-- WEBVIEW FIX: Load WebView fixes CSS -->
    <link rel="stylesheet" href="webview-fixes.css">
</head>
<body>
    <!-- Hamburger Menu Button (Mobile Only) -->
    <button class="hamburger-btn" id="hamburger-btn">
        <span></span>
        <span></span>
        <span></span>
    </button>

    <!-- Side Menu (Mobile Only) -->
    <div class="side-menu" id="side-menu">
        <div class="side-menu-header">
            <h2>Menu</h2>
            <button class="close-menu-btn" id="close-menu-btn">&times;</button>
        </div>
        <div class="side-menu-content">
            <button class="menu-item-btn new-game-menu-btn">
                <span class="menu-icon">üéÆ</span>
                New Game
            </button>
            <button class="menu-item-btn how-to-play-menu-btn">
                <span class="menu-icon">‚ùì</span>
                How to Play
            </button>
            <button class="menu-item-btn leaderboard-menu-btn">
                <span class="menu-icon">üèÜ</span>
                Leaderboard
            </button>
            <div class="menu-divider"></div>
            <div class="menu-theme-section">
                <label class="menu-label">Theme</label>
                <select id="theme-select-menu" class="menu-dropdown">
                    <option value="default">Classic</option>
                    <option value="dark">Dark Mode</option>
                    <option value="space">Mars</option>
                    <option value="minimalist">Minimalist</option>
                    <option value="eye-rest">Eye Resting</option>
                    <option value="ocean">Ocean Breeze</option>
                    <option value="forest">Forest</option>
                    <option value="sunset">Sunset</option>
                </select>
            </div>
            <div class="menu-divider"></div>
            <div class="menu-theme-section">
                <label class="menu-label">Favorite Dog</label>
                <select id="favorite-dog-select" class="menu-dropdown">
                    <option value="none">No Favorite (Random)</option>
                    <!-- Dog options are dynamically loaded from dogs-config.js -->
                </select>
                <p class="menu-hint">Your favorite will appear in every game!</p>
            </div>
        </div>
    </div>

    <!-- Menu Overlay -->
    <div class="menu-overlay" id="menu-overlay"></div>

    <div class="game-layout">
        <header class="game-header">
            <h1>üêæ Sudogu üêæ</h1>
        </header>

        <div class="controls-bar">
            <!-- Left: Difficulty -->
            <div class="difficulty-selector">
                <select id="difficulty-select" class="difficulty-dropdown">
                    <option value="easy">Easy</option>
                    <option value="medium">Medium</option>
                    <option value="hard">Hard</option>
                </select>
            </div>

            <!-- Right: Timer + Display + Pause -->
            <div class="right-controls-group">
                <!-- Timer toggle with display -->
                <div class="timer-control-group">
                    <!-- Timer display on the left -->
                    <span class="time-display">00:00</span>
                    <label class="toggle-item">
                        <span class="toggle-label">Timer</span>
                        <div class="toggle-switch">
                            <input type="checkbox" id="show-timer" class="toggle-checkbox">
                            <span class="toggle-slider"></span>
                        </div>
                    </label>
                </div>

                <!-- Pause toggle -->
                <label class="toggle-item pause-toggle">
                    <span class="toggle-label pause-label">Pause</span>
                    <div class="toggle-switch">
                        <input type="checkbox" id="pause-game" class="toggle-checkbox">
                        <span class="toggle-slider"></span>
                    </div>
                </label>
            </div>
        </div>

        <!-- Mobile compact controls row -->
        <div class="mobile-controls-row">
            <div class="mistakes-compact">
                <span class="label">‚ùå</span>
                <span class="mistakes-count">0</span>
            </div>
            <div class="board-controls-compact">
                <button class="icon-btn restart-btn" title="Restart">
                    <svg class="svg" width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                        <path d="M21.5 2v6h-6M2.5 22v-6h6M2 11.5a10 10 0 0 1 18.8-4.3M22 12.5a10 10 0 0 1-18.8 4.2"/>
                    </svg>
                </button>
            </div>
        </div>

        <!-- Desktop game info -->
        <div class="game-info">
            <div class="mistakes">
                <span class="label">‚ùå Mistakes:</span>
                <span class="mistakes-count">0</span>
            </div>
        </div>

        <div class="main-content">
            <div class="board-container">
                <div class="sudoku-board" id="sudoku-board"></div>
            </div>

            <div class="board-controls">
                <button class="icon-btn restart-btn" title="Restart Game">
                    <svg class="svg" width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                        <path d="M21.5 2v6h-6M2.5 22v-6h6M2 11.5a10 10 0 0 1 18.8-4.3M22 12.5a10 10 0 0 1-18.8 4.2"/>
                    </svg>
                    Restart Game
                </button>

                <div class="mobile-mistakes">
                    <span class="label">Mistakes: </span>
                    <span class="mistakes-count">0</span>
                </div>
            </div>

            <div class="side-panel">
                <div class="dog-panel">
                    <h3 class="panel-title">Drag a Dog</h3>
                    <div class="dog-list">
                    <div class="dog-item" data-num="1" draggable="true">
                        <div class="dog-header">
                            <span class="dog-name">Leka</span>
                            <span class="checkmark">‚úì</span>
                        </div>
                        <img src="photos/Leka.png" alt="Leka" draggable="false">
                    </div>
                    <div class="dog-item" data-num="2" draggable="true">
                        <div class="dog-header">
                            <span class="dog-name">Kozmo</span>
                            <span class="checkmark">‚úì</span>
                        </div>
                        <img src="photos/Kozmo.png" alt="Kozmo" draggable="false">
                    </div>
                    <div class="dog-item" data-num="3" draggable="true">
                        <div class="dog-header">
                            <span class="dog-name">Maya</span>
                            <span class="checkmark">‚úì</span>
                        </div>
                        <img src="photos/Maya.png" alt="Maya" draggable="false">
                    </div>
                    <div class="dog-item" data-num="4" draggable="true">
                        <div class="dog-header">
                            <span class="dog-name">Rio</span>
                            <span class="checkmark">‚úì</span>
                        </div>
                        <img src="photos/Rio.png" alt="Rio" draggable="false">
                    </div>
                    <div class="dog-item" data-num="5" draggable="true">
                        <div class="dog-header">
                            <span class="dog-name">George</span>
                            <span class="checkmark">‚úì</span>
                        </div>
                        <img src="photos/George.png" alt="George" draggable="false">
                    </div>
                    <div class="dog-item" data-num="6" draggable="true">
                        <div class="dog-header">
                            <span class="dog-name">Gofret</span>
                            <span class="checkmark">‚úì</span>
                        </div>
                        <img src="photos/Gofret.png" alt="Gofret" draggable="false">
                    </div>
                    <div class="dog-item" data-num="7" draggable="true">
                        <div class="dog-header">
                            <span class="dog-name">Ares</span>
                            <span class="checkmark">‚úì</span>
                        </div>
                        <img src="photos/Ares.png" alt="Ares" draggable="false">
                    </div>
                    <div class="dog-item" data-num="8" draggable="true">
                        <div class="dog-header">
                            <span class="dog-name">Tony</span>
                            <span class="checkmark">‚úì</span>
                        </div>
                        <img src="photos/Tony.png" alt="Tony" draggable="false">
                    </div>
                    <div class="dog-item" data-num="9" draggable="true">
                        <div class="dog-header">
                            <span class="dog-name">Hera</span>
                            <span class="checkmark">‚úì</span>
                        </div>
                        <img src="photos/Hera.png" alt="Hera" draggable="false">
                    </div>
                </div>
            </div>
            <div>
                <button class="btn leaderboard-btn">Leaderboard</button>
            </div>
        </div>

        <div class="message" id="message"></div>
    </div>

    <div id="achievement-overlay" class="achievement-overlay">
        <div class="achievement-content">
            <div class="achievement-icon">üéâ</div>
            <div class="achievement-text"></div>
            <div class="confetti-container"></div>
        </div>
    </div>

    <div id="how-to-play-modal" class="modal-overlay">
        <div class="modal-content">
            <button class="modal-close">&times;</button>
            <h2 class="modal-title">How to Play Sudogu</h2>
            <div class="modal-body">
                <p class="modal-subtitle">Fill each 3 √ó 3 set with different dogs.</p>
                <ul class="modal-instructions">
                    <li>Select a dog from the bottom, then tap an empty cell to place it.</li>
                    <li>After placing a dog, you must select again to place another one.</li>
                    <li>Fill all cells to complete the board.</li>
                    <li>If you make a mistake, tap once to remove a placed dog.</li>
                    <li>Dogs cannot repeat in the same set, row, or column.</li>
                </ul>
                <p style="text-align: center; font-size: 1.1rem; margin: 15px 0; color: var(--primary-color); font-weight: 700;"><strong>Have fun!</strong></p>
            </div>
        </div>
    </div>

    <div id="win-modal" class="modal-overlay">
        <div class="modal-content">
            <button class="modal-close">&times;</button>
            <h2 class="modal-title">üéâ Congratulations! üéâ</h2>
            <div class="modal-body">
                <p class="modal-subtitle win-stats"></p>
                <div class="name-input-section">
                    <label for="player-name">Enter your name for the leaderboard:</label>
                    <input type="text" id="player-name" class="player-name-input" placeholder="Your name (optional)" maxlength="20">
                    <button class="btn submit-score-btn">Submit Score</button>
                    <button class="btn skip-submit-btn">Skip</button>
                </div>
            </div>
        </div>
    </div>

    <div id="leaderboard-modal" class="modal-overlay">
        <div class="modal-content leaderboard-content">
            <button class="modal-close">&times;</button>
            <h2 class="modal-title">üèÜ Leaderboard üèÜ</h2>
            <div class="modal-body">
                <div class="difficulty-tabs">
                    <button class="tab-btn active" data-difficulty="easy">Easy</button>
                    <button class="tab-btn" data-difficulty="medium">Medium</button>
                    <button class="tab-btn" data-difficulty="hard">Hard</button>
                </div>
                <div class="leaderboard-list" id="leaderboard-list">
                    <p class="loading-text">Loading...</p>
                </div>
            </div>
        </div>
    </div>

    <!-- WEBVIEW FIX: Load detection script BEFORE game script -->
    <script src="webview-detection.js"></script>
    <script src="dogs-config.js"></script>
    <script src="sudoku.js"></script>
</body>
</html>
